# Version Control Best Practices

Guide for what should and shouldn't be committed to the repository.

---

## âœ… SHOULD Be Committed

### Source Code
- âœ… All `.java` files
- âœ… Resource files (`*.properties`, `*.yml`, `*.xml` in `src/`)
- âœ… Test files
- âœ… Configuration templates (without secrets)

### Build Configuration
- âœ… `pom.xml` (Maven project files)
- âœ… Maven wrapper files: `mvnw`, `mvnw.cmd`
- âœ… `.mvn/wrapper/maven-wrapper.properties`
- âœ… Gradle wrapper files (if using Gradle)

### Documentation
- âœ… `README.md`
- âœ… All markdown documentation files
- âœ… Module-specific READMEs
- âœ… Code comments and JavaDoc
- âœ… License file

### Project Configuration
- âœ… `.gitignore` file
- âœ… `.gitattributes` (if present)
- âœ… CI/CD configuration files (GitHub Actions, etc.)
- âœ… Docker files (if applicable)

---

## âŒ SHOULD NOT Be Committed

### IDE-Specific Files (Security & Portability)
- âŒ `.idea/` directory (IntelliJ IDEA)
  - Contains user-specific paths
  - May contain database credentials
  - May contain AWS/cloud credentials
  - May contain run configuration with sensitive data
- âŒ `*.iml` files (IntelliJ module files)
- âŒ `.vscode/` (VS Code settings)
- âŒ `.settings/` (Eclipse settings)
- âŒ IDE workspace files

**Why?** Each developer may use different IDEs or different IDE versions. These files contain local paths and user-specific settings that won't work on other machines.

### Build Outputs
- âŒ `target/` directory (Maven)
- âŒ `build/` directory (Gradle)
- âŒ `out/` directory
- âŒ `*.class` files
- âŒ `*.jar`, `*.war`, `*.ear` (build artifacts)

**Why?** These are generated during build and can be reproduced from source code. Including them wastes repository space and causes merge conflicts.

### Logs & Temporary Files
- âŒ `*.log` files
- âŒ `*.tmp`, `*.temp`, `*.bak` files
- âŒ Cache directories
- âŒ OS-specific files (`.DS_Store`, `Thumbs.db`)

**Why?** These are temporary or system-specific and have no value in version control.

### Secrets & Credentials (CRITICAL SECURITY!)
- âŒ `.env` files with API keys
- âŒ `secrets.properties`
- âŒ `application-local.yml` with database passwords
- âŒ `*.pem`, `*.key` (SSH keys, certificates)
- âŒ `*.jks`, `*.p12` (keystores)
- âŒ AWS credentials files
- âŒ GCP service account keys
- âŒ API tokens and keys

**Why?** SECURITY RISK! These files contain sensitive information. If committed, they're exposed in git history forever (even if deleted later).

### Dependencies
- âŒ `.m2/repository/` (Maven local cache)
- âŒ `node_modules/` (if using Node)
- âŒ Downloaded JARs and libraries

**Why?** Dependencies should be declared in `pom.xml` and downloaded by Maven. Including them makes the repository huge.

---

## ğŸ”’ Security Concerns

### .idea/ Directory Issues

The `.idea/` directory can contain:

1. **Database Credentials**
   - `dataSources.xml` - database connection strings with passwords
   - `dataSources.local.xml` - local database configs

2. **Cloud Credentials**
   - `aws.xml` - AWS access keys
   - Cloud service configurations

3. **Local Paths**
   - `workspace.xml` - absolute paths on your machine
   - `libraries/` - paths to JARs on your system

4. **API Keys**
   - Run configurations with environment variables
   - Debugging configurations with tokens

**Solution:** Always ignore `.idea/` completely. Share only project-level configurations through `pom.xml`.

### vcs.xml Specifically

`vcs.xml` contains:
- VCS root paths (local file system paths)
- Git branch configurations
- Mapping settings

**Should it be committed?** NO
- It's user-specific
- Contains local paths
- Automatically regenerated by IDE
- Different for each developer

---

## ğŸ›¡ï¸ Best Practices

### 1. Never Commit Secrets

**Bad (Don't do this):**
```properties
# application.properties
database.password=mySecret123
api.key=abc123xyz
```

**Good (Do this):**
```properties
# application.properties (template)
database.password=${DB_PASSWORD}
api.key=${API_KEY}
```

Use environment variables or external configuration.

### 2. Use .gitignore Early

- Set up `.gitignore` BEFORE your first commit
- Use comprehensive patterns
- Review before committing new files

### 3. Check What You're Committing

```bash
# See what will be committed
git status

# See actual changes
git diff

# Add specific files only
git add src/main/java/MyClass.java

# Avoid "git add ."" unless you're sure
```

### 4. If You Accidentally Committed Secrets

**CRITICAL:** If you committed secrets, they're in git history!

**Steps to fix:**
1. Rotate/invalidate the exposed credentials immediately
2. Remove from git history:
   ```bash
   # Remove file from all history
   git filter-branch --force --index-filter \
     "git rm --cached --ignore-unmatch path/to/secrets.properties" \
     --prune-empty --tag-name-filter cat -- --all
   
   # Force push (be careful!)
   git push origin --force --all
   ```
3. Add to `.gitignore` immediately
4. Never use those credentials again

**Better:** Use tools like `git-secrets` or `detect-secrets` to prevent committing secrets.

### 5. Repository Hygiene

```bash
# Clean up ignored files already committed
git rm -r --cached .
git add .
git commit -m "Clean up gitignore"

# Check repository size
du -sh .git

# Remove large files from history if needed
# Use tools like BFG Repo-Cleaner
```

---

## ğŸ“‹ Checklist Before Committing

- [ ] No `.idea/` directory files
- [ ] No `target/` or `build/` directories
- [ ] No `.env` files or secrets
- [ ] No IDE-specific files (`.iml`, etc.)
- [ ] No log files
- [ ] No local configuration with passwords
- [ ] No large binary files (unless necessary)
- [ ] No personal information
- [ ] `.gitignore` is up to date

---

## ğŸ” How to Check Your Repository

### Check for secrets:
```bash
# Search for common secret patterns
git grep -i "password"
git grep -i "api.key"
git grep -i "secret"
git grep -i "token"

# Check for credential files
find . -name "*.env"
find . -name "*secret*"
find . -name "*credential*"
```

### Check for IDE files:
```bash
# See if .idea is being tracked
git ls-files | grep "\.idea"

# If it is, remove it
git rm -r --cached .idea
git commit -m "Remove .idea from version control"
```

### Check repository size:
```bash
# See largest files in git history
git rev-list --objects --all \
  | git cat-file --batch-check='%(objecttype) %(objectname) %(objectsize) %(rest)' \
  | sed -n 's/^blob //p' \
  | sort --numeric-sort --key=2 \
  | tail -10
```

---

## ğŸ¯ Quick Reference

### What Goes in Git?
âœ… Source code  
âœ… Build configs (`pom.xml`)  
âœ… Documentation  
âœ… Maven wrapper (`mvnw`, `mvnw.cmd`)  
âœ… `.gitignore`  

### What Stays Local?
âŒ `.idea/`  
âŒ `target/`  
âŒ `.env` files  
âŒ Secrets  
âŒ IDE configs  
âŒ Build outputs  

---

## ğŸ“š Resources

- [GitHub's gitignore templates](https://github.com/github/gitignore)
- [Git-secrets tool](https://github.com/awslabs/git-secrets)
- [BFG Repo-Cleaner](https://rtyley.github.io/bfg-repo-cleaner/)
- [Removing sensitive data from a repository](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository)

---

## âœ… Your Project Status

The `.gitignore` has been updated to properly exclude:
- âœ… All `.idea/` files and subdirectories
- âœ… `vcs.xml` specifically
- âœ… Maven wrapper JAR (but keeps scripts)
- âœ… All build outputs
- âœ… Secret files and credentials
- âœ… IDE-specific configurations
- âœ… OS-specific files
- âœ… Temporary and cache files

**Next steps:**
1. Remove any already-committed IDE files:
   ```bash
   git rm -r --cached .idea
   git commit -m "Remove .idea from version control"
   ```

2. Verify clean status:
   ```bash
   git status
   ```

3. Only commit source code and documentation going forward!

---

*Last Updated: November 30, 2025*

